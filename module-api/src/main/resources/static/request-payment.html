<!DOCTYPE html>
<html>
<head>
  <title>결제 테스트</title>
  <meta charset="UTF-8">
  <script src="https://js.tosspayments.com/v1/payment"></script>
</head>
<body>
<h1>토스페이먼츠 테스트</h1>
<button onclick="requestPayment()">결제하기</button>

<script>
  const clientKey = 'test_ck_pP2YxJ4K87Z9dKKBg9y0rRGZwXLO';
  const tossPayments = TossPayments(clientKey);

  async function requestPayment() {
    // 1. 백엔드에서 paymentOrderId 받기
    const response = await fetch('/api/payments/prepare', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': 'Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiI4Iiwicm9sZXMiOlsiUk9MRV9VU0VSIl0sImlhdCI6MTc2MTE0MTMwOSwiZXhwIjoxNzYxMTQxOTA5fQ.xc_Lfwm8tqFATE9VIuhL1M63FI4kdedtGoEpXRa7YS0'
      },
      body: JSON.stringify({
        "orderId":5,
        "amount":240000,
        "description":null
      })
    });
    const data = await response.json();
    console.log(data);

    // 2. 토스 결제창 오픈
    tossPayments.requestPayment('카드', {
      amount: data.amount,
      orderId: data.orderId,
      orderName: data.orderName || '테스트 주문',
      successUrl: window.location.origin + '/payment-success',
      failUrl: window.location.origin + '/payment-fail',
    });
  }
</script>
</body>
</html>